const puppeteer = require('puppeteer');

const linecodes = 
[
  '5116415016575016',
  '5408200058296223',
  '9461834072502724',
  '8362720729034292',
  '4613555101395401',
  '4272790794680908',
  '8615022640029898',
  '1203171908820691',
  '7671116793793975',
  '9395424221174859',
  '3824739594491618',
  '5252538596350122',
  '5339546942335536',
  '5077840145467029',
  '6534177099725319',
  '1039561568412747',
  '1167596650157026',
  '1180383560132733',
  '1280723141786971',
  '1343139933054847',
  '1364243772194380',
  '1564738150762643',
  '1640275484054464',
  '1787175450607087',
  '1823751988040965',
  '1823861360791992',
  '1846747111752368',
  '1861131517119097',
  '1946039908714289',
  '1948610527449712',
  '1954467332931617',
  '2068824074120706',
  '2092981423273317',
  '2094236034120019',
  '2232312742036154',
  '2280314092580268',
  '2303484963835734',
  '2304687264679333',
  '2419777645319021',
  '2476618762987954',
  '2485286821772004',
  '2488691127941332',
  '2517394033245279',
  '2570149483973231',
  '2630307928951017',
  '2651377561670125',
  '2684397468334405',
  '2700374857244364',
  '2901768196385852',
  '2905391513642658',
  '3099609390548488',
  '3105870769079115',
  '3215482609656408',
  '3227034691313999',
  '3246400066002445',
  '3359939790271069',
  '3438237823636327',
  '3543803867653762',
  '3556097935816131',
  '3599823335458870',
  '3748163396303992',
  '3777408270670186',
  '3839781381575213',
  '3863135329862978',
  '3952454114020427',
  '3968131093938127',
  '3985737864417318',
  '4122885634268157',
  '4195242407142268',
  '4213081670876873',
  '4215471373543730',
  '4272267488652179',
  '4294901723314339',
  '4301191297455304',
  '4326297770163689',
  '4344606148473976',
  '4372320679639578',
  '4395960704911926',
  '4475350540817051',
  '4497027795886163',
  '4514088772287181',
  '4554219724229879',
  '4613658251199391',
  '4840915719191722',
  '4883649325166546',
  '4909289068085200',
  '4915986138159856',
  '4954784584209496',
  '5009323695748748',
  '5022029589847188',
  '5091491285172913',
  '5110108083991153',
  '5111183648079619',
  '5128513801110220',
  '5169688274639910',
  '5172934573295590',
  '5176429483382000',
  '5272665718347536',
  '5282054284996277',
  '5296535951531810',
  '5314010791621946',
  '5585296907556484',
  '5586838453343659',
  '5597738597328138',
  '5604556387171135',
  '5612299873340390',
  '5669420533657353',
  '5697721238929990',
  '5782591503655956',
  '5804312847891910',
  '5865619535086296',
  '5921850702649536',
  '5954817295979910',
  '6177787171069455',
  '6181019165090582',
  '6220597569495370',
  '6338794374670433',
  '6450300419904424',
  '6549945333599193',
  '6579916296962276',
  '6593191145463497',
  '6609782179841583',
  '6623296784295903',
  '6661862233945477',
  '6680309186239835',
  '6690856289840671',
  '6744203709889548',
  '6756040301205226',
  '6979225844556992',
  '6991288662331156',
  '7076289922449171',
  '7189987040199158',
  '7225518291546506',
  '7292954182126389',
  '7331334938921507',
  '7375548768237372',
  '7525788226314620',
  '7566631223515147',
  '7729081584531816',
  '7777660163867484',
  '7793416470526091',
  '7905103743154524',
  '7935972496260294',
  '8020959068793091',
  '8056293257625504',
  '8080006097120919',
  '8230015953949317',
  '8271685843414731',
  '8310191721161840',
  '8339723626891407',
  '8351778413807167',
  '8401748180506418',
  '8427744596408861',
  '8616729773365776',
  '8634275957497816',
  '8674313858082837',
  '8750951068861171',
  '8790753525507107',
  '8853551751133963',
  '8881481446970874',
  '8901895228126782',
  '8987559518202019',
  '9019503942617105',
  '9167170278397295',
  '9281646740216599',
  '9314441717855053',
  '9320850188614836',
  '9323011023259429',
  '9326859783814285',
  '9336528832750654',
  '9338932816435771',
  '9372596790579870',
  '9615566968310938',
  '9637138684362416',
  '9798722479919817',
  '9832732053517320',
  '9968309686765942',
  '9988808327034873',
  '1348869278804374',
  '1373524779939452',
  '1419713675730957',
  '1487719863736073',
  '1549484735969991',
  '1584994582030740',
  '1585401789320356',
  '1834793426900669',
  '2004730522681340',
  '2179175407496244',
  '2217376777928731',
  '2324357929033680',
  '2539591294230993',
  '2590152370758710',
  '2923020492518089',
  '3072574169175275',
  '3119366341380415',
  '3122648233520986',
  '3173010207675876',
  '3303441832817482',
  '3313602555058491',
  '3313880148723967',
  '3331774934018112',
  '3353878418620449',
  '3401770997286595',
  '3447402603175066',
  '3470829614942158',
  '3559246259359601',
  '3967246409857624',
  '4107626549143880',
  '4475539027326321',
  '4623490532025895',
  '4729082654135502',
  '5034576873701577',
  '5137331523812756',
  '5361536029308647',
  '5467663235949810',
  '5558498634099024',
  '5747545909542627',
  '5918664132527565',
  '6118415331150376',
  '6168633545252157',
  '6203332115420036',
  '6382241070410897',
  '6462737342226962',
  '6503420329703596',
  '6529091567370567',
  '6985977256446050',
  '7245272194413305',
  '7569402977079413',
  '7847044366596862',
  '8025878209115654',
  '8031375434109027',
  '8153601682319009',
  '8262552914278058',
  '8270146161464924',
  '8400250865240732',
  '8426028164176585',
  '8506296454349433',
  '8518512928539287',
  '8565312909449026',
  '8867904664729399',
  '9032053663494033',
  '9122516009677103',
  '9260702573066232',
  '9389840926026919',
  '9512896150583418',
  '9623784763688750',
  '9718828175251781',
  '9958043662477305'
    ];

(async () => {
  // Puppeteerの起動
  const browser = await puppeteer.launch({
    headless: false, //HeadLessモードでの起動有無
    slowMo: 50, // 指定のミリ秒スローモーションで実行する
  });

  // 新しい空のページを開く
  const page = await browser.newPage();

  // Promise定義
  const navigationPromise = page.waitForNavigation()

  // view portの設定
  await page.setViewport({
    width: 1200,
    height: 800,
  })
  
  // 開く先のWebサイトへ遷移
  await page.goto('https://points.line.me/pointcode/#/pointcode/form')
  
  await page.setViewport({ width: 1366, height: 803 })
  
  await navigationPromise
  
  await page.waitForSelector('#mainView #pincode')
  await page.click('#mainView #pincode')
  let pincode = '9999999999999999' // 繰り返しをシンプルにするためにダミーの数値を出す

  await page.type('input[name="pincode"]', pincode)
  
  await page.waitForSelector('#mainView > div > form > .MdBtn01 > button')
  await page.click('#mainView > div > form > .MdBtn01 > button')
  
  await navigationPromise
  
  await page.waitForSelector('.arLoginWrapInner > .MdMN01LoginForm > form > .mdMN01Btn > .MdBtn03Login')
  await page.type('input[name="tid"]', 'teraco@gmail.com')
  await page.type('input[name="tpasswd"]', 'kd1xwinl')

  await page.click('.arLoginWrapInner > .MdMN01LoginForm > form > .mdMN01Btn > .MdBtn03Login')
  
  await navigationPromise
  await new Promise(r => setTimeout(r, 3000));


  // 2週目
  for (const linecode of linecodes) {

    console.log(linecode)
    let pincode = linecode;

    await page.goto('https://points.line.me/pointcode/#/pointcode/form')
    await page.waitForSelector('#mainView #pincode')
    await page.click('#mainView #pincode')
    await page.type('input[name="pincode"]', pincode)
    
    await page.waitForSelector('#mainView > div > form > .MdBtn01 > button')
    await page.click('#mainView > div > form > .MdBtn01 > button')

    await navigationPromise
    await new Promise(r => setTimeout(r, 3000));
  
    await page.waitForSelector('.lyContentsInner > #mainView > div > .MdBtn01 > a')
    await page.click('.lyContentsInner > #mainView > div > .MdBtn01 > a')
      
    await navigationPromise
    await new Promise(r => setTimeout(r, 3000));
    console.log('OK');
    
  };

})();
